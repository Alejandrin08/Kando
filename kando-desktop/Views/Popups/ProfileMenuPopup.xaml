<?xml version="1.0" encoding="utf-8" ?>
<toolkit:Popup xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
               xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
               xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
               xmlns:strings="clr-namespace:kando_desktop.Resources.Strings"
               x:Class="kando_desktop.Views.Popups.ProfileMenuPopup"
               xmlns:local="clr-namespace:kando_desktop"
               Color="Transparent">

    <Border StrokeShape="RoundRectangle 12"
            StrokeThickness="1"
            BackgroundColor="{AppThemeBinding Light={StaticResource MenuBgLight}, Dark={StaticResource MenuBgDark}}"
            Stroke="{AppThemeBinding Light={StaticResource Slate200}, Dark={StaticResource MenuBorderDark}}"
            Padding="4"
            Margin="0"
            WidthRequest="230" 
            HeightRequest="130"
            TranslationX="-100"
            TranslationY="5"
            HorizontalOptions="Start">

        <Border.Shadow>
            <Shadow Brush="Black" Offset="0,2" Radius="8" Opacity="0.1"/>
        </Border.Shadow>

        <VerticalStackLayout Spacing="2">

            <Label Text="{Binding UserName}"
                   TextColor="{AppThemeBinding Light=Black, Dark=White}"
                   FontSize="14"
                   Margin="4,5,0,0"
                   FontAttributes="Bold"/>

            <Label Text="{Binding UserEmail}"
                   Margin="4,-3,0,2"
                   TextColor="{x:StaticResource Slate400}"
                   FontSize="12"/>

            <BoxView HeightRequest="1" 
                     Margin="4,1" 
                     Color="{AppThemeBinding Light={StaticResource MenuSeparatorLight}, Dark={StaticResource MenuSeparatorDark}}"/>

            <Border Style="{StaticResource MenuItemBorderStyle}" x:Name="EditProfileBtn" local:CursorBehavior.Cursor="Hand">
                <Border.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding EditProfileCommand}"/>
                </Border.GestureRecognizers>

                <Grid ColumnDefinitions="24, *">
                    <Image Source="{AppThemeBinding Light=gear_black.png, Dark=gear_white.png}"
                           HeightRequest="16" WidthRequest="16"
                           HorizontalOptions="Center" VerticalOptions="Center">
                        <Image.Triggers>
                            <DataTrigger TargetType="Image" Binding="{Binding Source={x:Reference EditProfileBtn}, Path=BackgroundColor}" Value="#0b64f4">
                                <Setter Property="Source" Value="gear_white.png"/>
                            </DataTrigger>
                            <DataTrigger TargetType="Image" Binding="{Binding Source={x:Reference EditProfileBtn}, Path=BackgroundColor}" Value="#3c83f6">
                                <Setter Property="Source" Value="gear_black.png"/>
                            </DataTrigger>
                        </Image.Triggers>
                    </Image>

                    <Label Grid.Column="1" 
                           Text="{x:Static strings:AppResources.EditProfile}" 
                           Style="{StaticResource MenuItemLabelStyle}">
                        <Label.Triggers>
                            <DataTrigger TargetType="Label" Binding="{Binding Source={x:Reference EditProfileBtn}, Path=BackgroundColor}" Value="#0b64f4">
                                <Setter Property="TextColor" Value="White"/>
                            </DataTrigger>
                            <DataTrigger TargetType="Label" Binding="{Binding Source={x:Reference EditProfileBtn}, Path=BackgroundColor}" Value="#3c83f6">
                                <Setter Property="TextColor" Value="Black"/>
                            </DataTrigger>
                        </Label.Triggers>
                    </Label>
                </Grid>
            </Border>

            <BoxView HeightRequest="1" 
                     Margin="4,1" 
                     Color="{AppThemeBinding Light={StaticResource MenuSeparatorLight}, Dark={StaticResource MenuSeparatorDark}}"/>

            <Border Style="{StaticResource MenuItemBorderStyle}" x:Name="LogoutBtn" local:CursorBehavior.Cursor="Hand">
                <Border.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding LogoutCommand}"/>
                </Border.GestureRecognizers>

                <Grid ColumnDefinitions="24, *">
                    <Image Source="logout_red.png" 
                           HeightRequest="16" WidthRequest="16"
                           HorizontalOptions="Center" VerticalOptions="Center">
                        <Image.Triggers>
                            <DataTrigger TargetType="Image" Binding="{Binding Source={x:Reference LogoutBtn}, Path=BackgroundColor}" Value="#0b64f4">
                                <Setter Property="Source" Value="logout_white.png"/>
                            </DataTrigger>
                            <DataTrigger TargetType="Image" Binding="{Binding Source={x:Reference LogoutBtn}, Path=BackgroundColor}" Value="#3c83f6">
                                <Setter Property="Source" Value="logout_black.png"/>
                            </DataTrigger>
                        </Image.Triggers>
                    </Image>

                    <Label Grid.Column="1" 
                           Text="{x:Static strings:AppResources.Logout}"
                           Style="{StaticResource MenuItemDangerLabelStyle}">
                        <Label.Triggers>
                            <DataTrigger TargetType="Label" Binding="{Binding Source={x:Reference LogoutBtn}, Path=BackgroundColor}" Value="#0b64f4">
                                <Setter Property="TextColor" Value="White"/>
                            </DataTrigger>
                            <DataTrigger TargetType="Label" Binding="{Binding Source={x:Reference LogoutBtn}, Path=BackgroundColor}" Value="#3c83f6">
                                <Setter Property="TextColor" Value="Black"/>
                            </DataTrigger>
                        </Label.Triggers>
                    </Label>
                </Grid>
            </Border>

        </VerticalStackLayout>
    </Border>
</toolkit:Popup>